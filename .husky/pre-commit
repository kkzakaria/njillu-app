#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Type checking
echo "âš¡ Type checking..."
pnpm type-check || {
  echo "âŒ Type check failed"
  exit 1
}

# Linting
echo "ğŸ§¹ Linting..."
pnpm lint:fix || {
  echo "âŒ Linting failed"
  exit 1
}

# Format check
echo "ğŸ’„ Checking formatting..."
pnpm format:check || {
  echo "âŒ Format check failed. Running formatter..."
  pnpm format
}

# Security audit
echo "ğŸ”’ Security audit..."
pnpm check:security || {
  echo "âš ï¸ Security vulnerabilities found"
  exit 1
}

# Run staged files through lint-staged
npx lint-staged

echo "âœ… All pre-commit checks passed!"